<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Title -->
    <title>會員 | Veloce Guard</title>

    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

    <!-- Favicon -->
    <link rel="shortcut icon" href="public/img/favicon.ico" />

    <!-- Template -->
    <link
      rel="stylesheet"
      href="public/graindashboard/css/graindashboard.css"
    />
  </head>

  <body class="has-sidebar has-fixed-sidebar-and-header">
    <!-- Header -->
    <header class="header bg-body">
      <nav class="navbar flex-nowrap p-0">
        <div class="navbar-brand-wrapper d-flex align-items-center col-auto">
          <!-- Logo For Mobile View -->
          <a class="navbar-brand navbar-brand-mobile" href="/">
            <img
              class="img-fluid w-100"
              src="public/img/logo-mini.png"
              alt="Graindashboard"
            />
          </a>
          <!-- End Logo For Mobile View -->

          <!-- Logo For Desktop View -->
          <a class="navbar-brand navbar-brand-desktop" href="/">
            <img
              class="side-nav-show-on-closed"
              src="public/img/logo-mini.png"
              alt="Graindashboard"
              style="width: auto; height: 33px"
            />
            <img
              class="side-nav-hide-on-closed"
              src="public/img/logo.png"
              alt="Graindashboard"
              style="width: auto; height: 33px"
            />
          </a>
          <!-- End Logo For Desktop View -->
        </div>

            <div class="header-content col px-md-3">
                <div class="d-flex align-items-center">
                    <!-- Side Nav Toggle -->
                    <a class="js-side-nav header-invoker d-flex mr-md-2" href="#" data-close-invoker="#sidebarClose"
                        data-target="#sidebar" data-target-wrapper="body">
                        <i class="gd-align-left"></i>
                    </a>
                    <!-- End Side Nav Toggle -->
                </div>
            </div>
        </nav>
    </header>
    <!-- End Header -->

    <main class="main">
      <!-- Sidebar Nav -->
      <aside id="sidebar" class="js-custom-scroll side-nav">
        <ul id="sideNav" class="side-nav-menu side-nav-menu-top-level mb-0">
          <!-- Title -->
          <li class="sidebar-heading h6">會員相關</li>
          <!-- End Title -->

          <!-- 會員 -->
          <li class="side-nav-menu-item side-nav-has-menu">
            <a
              class="side-nav-menu-link media align-items-center"
              href="#"
              data-target="#subUsers"
            >
              <span class="side-nav-menu-icon d-flex mr-3">
                <i class="gd-user"></i>
              </span>
              <span class="side-nav-fadeout-on-closed media-body">會員</span>
              <span class="side-nav-control-icon d-flex">
                <i class="gd-angle-right side-nav-fadeout-on-closed"></i>
              </span>
              <span
                class="side-nav__indicator side-nav-fadeout-on-closed"
              ></span>
            </a>

                    <!-- Users: subUsers -->
                    <ul id="subUsers" class="side-nav-menu side-nav-menu-second-level mb-0">
                        <li class="side-nav-menu-item active">
                            <a class="side-nav-menu-link" href="users.html">所有會員</a>
                        </li>
                    </ul>
                    <!-- End Users: subUsers -->
                </li>
                <!-- End Users -->
                <!-- Title -->
                <li class="sidebar-heading h6">訂單相關</li>
                <!-- End Title -->

          <!-- 訂單 -->
          <li class="side-nav-menu-item side-nav-has-menu">
            <a
              class="side-nav-menu-link media align-items-center"
              href="#"
              data-target="#subPages"
            >
              <span class="side-nav-menu-icon d-flex mr-3">
                <i class="gd-shopping-cart-full"></i>
              </span>
              <span class="side-nav-fadeout-on-closed media-body">訂單</span>
              <span class="side-nav-control-icon d-flex">
                <i class="gd-angle-right side-nav-fadeout-on-closed"></i>
              </span>
              <span
                class="side-nav__indicator side-nav-fadeout-on-closed"
              ></span>
            </a>

            <!-- Pages: subPages -->
            <ul
              id="subPages"
              class="side-nav-menu side-nav-menu-second-level mb-0"
            >
              <li class="side-nav-menu-item">
                <a class="side-nav-menu-link" href="order.html">所有訂單</a>
              </li>
              <li class="side-nav-menu-item">
                <a class="side-nav-menu-link" href="order-edit.html"
                  >新增訂單</a
                >
              </li>
            </ul>
            <!-- End Pages: subPages -->
          </li>
          <!-- End 訂單 -->

          <!-- Title -->
          <li class="sidebar-heading h6">商品相關</li>
          <!-- End Title -->

          <!-- 商品 -->
          <li class="side-nav-menu-item side-nav-has-menu">
            <a
              class="side-nav-menu-link media align-items-center"
              href="#"
              data-target="#subitems"
            >
              <span class="side-nav-menu-icon d-flex mr-3">
                <i class="gd-package"></i>
              </span>
              <span class="side-nav-fadeout-on-closed media-body">商品</span>
              <span class="side-nav-control-icon d-flex">
                <i class="gd-angle-right side-nav-fadeout-on-closed"></i>
              </span>
              <span
                class="side-nav__indicator side-nav-fadeout-on-closed"
              ></span>
            </a>

            <!-- subitems -->
            <ul
              id="subitems"
              class="side-nav-menu side-nav-menu-second-level mb-0"
            >
              <li class="side-nav-menu-item active">
                <a class="side-nav-menu-link" href="product.html">所有商品</a>
              </li>
              <li class="side-nav-menu-item">
                <a class="side-nav-menu-link" href="product-edit.html"
                  >新增商品</a
                >
              </li>
            </ul>
            <!--  subitems -->
          </li>
          <!-- End 商品 -->

                <!-- Title -->
                <li class="sidebar-heading h6">聯絡我們相關</li>
                <!-- End Title -->
                
                <!-- 優惠卷 -->
                <li class="side-nav-menu-item side-nav-has-menu ">
                    <a class="side-nav-menu-link media align-items-center" href="#" data-target="#subticket">
                        <span class="side-nav-menu-icon d-flex mr-3">
                            <i class="gd-comment-alt"></i>
                        </span>
                        <span class="side-nav-fadeout-on-closed media-body">聯絡我們</span>
                        <span class="side-nav-control-icon d-flex">
                            <i class="gd-angle-right side-nav-fadeout-on-closed"></i>
                        </span>
                        <span class="side-nav__indicator side-nav-fadeout-on-closed"></span>
                    </a>

                    <!--  subticket -->
                    <ul id="subticket" class="side-nav-menu side-nav-menu-second-level mb-0">
                        <li class="side-nav-menu-item active">
                            <a class="side-nav-menu-link" href="#">所有回饋</a>
                        </li>
                       
                    </ul>
                    <!-- subticket -->
                </li>
                <!-- End 優惠卷 -->



                

            </ul>
        </aside>
        <!-- End Sidebar Nav -->

      <div class="content">
        <div class="py-4 px-3 px-md-4">
          <div class="card mb-3 mb-md-4">
            <div class="card-body">
              <!-- Breadcrumb -->
              <nav class="d-none d-md-block" aria-label="breadcrumb">
                <ol class="breadcrumb">
                  <li class="breadcrumb-item">
                    <a href="#">會員</a>
                  </li>
                  <li class="breadcrumb-item active" aria-current="page">
                    所有會員
                  </li>
                </ol>
              </nav>
              <!-- End Breadcrumb -->

              <div class="mb-3 mb-md-4 d-flex justify-content-between">
                <div class="h3 mb-0">會員</div>
              </div>

                        <!-- Users -->
                        <div class="table-responsive-xl">
                            <table class="table text-nowrap mb-0">
                                <thead>
                                    <tr>
                                        <th class="font-weight-semi-bold border-top-0 py-2">會員ID</th>
                                        <th class="font-weight-semi-bold border-top-0 py-2">姓名</th>
                                        <th class="font-weight-semi-bold border-top-0 py-2">Email</th>
                                        <th class="font-weight-semi-bold border-top-0 py-2">電話號碼</th>
                                        <!-- <th class="font-weight-semi-bold border-top-0 py-2">Status</th> -->
                                        <th class="font-weight-semi-bold border-top-0 py-2">操作</th>
                                    </tr>
                                </thead>
                                <tbody id="user-table-body">
    <!------------------------------------渲染會員從資料庫使用AJAX ------------------------------------------------>
                                    <script>

                                        $(document).ready(function () {
                                            function fetchUsers(page = 1) {
                                                $.ajax({
                                                    url: 'http://localhost:8080/api/admin/users?pageNumber=0&pageSize=10&sortBy=userId&sortOrder=asc', // 更改為你的 API URL
                                                    method: 'GET',
                                                    dataType: 'json',
                                                    headers: {
                                                        
                'Authorization': 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJVc2VyIERldGFpbHMiLCJpc3MiOiJFdmVudCBTY2hlZHVsZXIiLCJpYXQiOjE3MTg4NjEzMjgsImVtYWlsIjoiam9obi5kb2VAZXhhbXBsZS5jb20ifQ.iUM0sEEZU9aHhhFM3rqAhw9VV2K_cvGrzg0ISC9lOiI'
            },
                                                    success: function (response) {
                                                        console.log(response)
                                                        // const users = response.users;
                                                        // const totalPages = response.totalPages;
                                                        // renderTable(response.content);
                                                        // renderPagination(totalPages, page);
                                                        // $('#pagination-info').text(`Showing ${response.from} to ${response.to} of ${response.total} Entries`);
                                                    },
                                                    error: function (err) {
                                                        console.log(err);
                                                        renderTable(err.responseJSON.content); // 假設你的API返回的產品資料在 'products' 屬性下
                                                    }
                                                });
                                            }

                        function renderTable(users) {
                          const tbody = $("#user-table-body");
                          tbody.empty();

                                                users.forEach(user => {
                                                    const row = `
                 <tr data-user-id="${user.userId}">
                    <td class="py-3">${user.userId}</td>
                    <td class="align-middle py-3">
                        <div class="d-flex align-items-center">
                            <div class="position-relative mr-2">
                                <span class="avatar-placeholder mr-md-2">${user.firstName.charAt(
                                  0
                                )}</span>
                            </div>
                            ${user.firstName}
                        </div>
                    </td>
                    <td class="py-3">${user.email}</td>
                    <td class="py-3">${user.mobileNumber}</td>
                    
                    <td class="py-3">
                        <div class="position-relative">
                            <a class="link-dark d-inline-block" href="#">
                                <i class="gd-pencil icon-text"></i>
                            </a>
                            <a class="link-dark d-inline-block" href="#">
                                <i class="gd-trash icon-text"></i>
                            </a>
                        </div>
                    </td>
                </tr>`;
                                                    tbody.append(row);
                                                });
                                            }

                                            // Fetch initial data
                                            fetchUsers();
                                        });



                                    </script>
       <!-------------------------------------------- 結束渲染 -------------------------------------------------------->
                                </tbody>
                            </table>
                           
                        <!-- End Users -->
                    </div>
                </div>


            </div>

     
        </div>
    </main>

    <!-- Edit User Modal修改按鈕 -->
    <div
      class="modal fade"
      id="editUserModal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="editUserModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="editUserModalLabel">Edit User</h5>
            <button
              type="button"
              class="close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <form id="editUserForm">
              <input type="hidden" id="editUserId" />
              <div class="form-group">
                <label for="editUserName">Name</label>
                <input
                  type="text"
                  class="form-control"
                  id="editUserName"
                  required
                />
              </div>
              <div class="form-group">
                <label for="editUserEmail">Email</label>
                <input
                  type="email"
                  class="form-control"
                  id="editUserEmail"
                  required
                />
              </div>
              <div class="form-group">
                <label for="editUserStatus">Status</label>
                <select class="form-control" id="editUserStatus" required>
                  <option value="Verified">Verified</option>
                  <option value="Pending">Pending</option>
                </select>
              </div>
              <button type="submit" class="btn btn-primary">
                Save changes
              </button>
            </form>
          </div>
        </div>
      </div>
    </div>

  <!-- <script src="/user_script.js"></script> -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="public/graindashboard/js/graindashboard.js"></script>
    <script src="public/graindashboard/js/graindashboard.vendor.js"></script>
  </body>
</html>
